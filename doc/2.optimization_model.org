** 1.Routing: Bi-objective Routing Decomposition (BiRD)
   :PROPERTIES:
   :CUSTOM_ID: routing-bi-objective-routing-decomposition-bird
   :END:

Decomposing the routing problem:

1. single-school

   1. stop assignment
   2. single-school routing

2. multi-school

   1. scenario selection
   2. bus scheduling

*** 1.1 Stop Assignment
    :PROPERTIES:
    :CUSTOM_ID: stop-assignment
    :END:

**** Set/Parameters
     :PROPERTIES:
     :CUSTOM_ID: setparameters
     :END:

| Identifier   | Index/Set Domain    | Comment                                                |
|--------------+---------------------+--------------------------------------------------------|
| schools      | S                   | set of schools                                         |
| students     | P                   | set of students                                        |
| $P_s$        | $s \in S$           | set of students attending school s                     |
| Locations    | C                   | set of all locations can serve as bus stops            |
| $C_p$        | $C_p \subseteq C$   | Allowed bus stops for student $p \in P_s$              |
| $d_{p,c}$    |                     | walking distance for student p to a stop $c \in C_p$   |

For student p with special needs may require a "door-to-door" pickup:
the set $C_p$ is a singleton ${c}$, where $d_{p,c} = 0$.

The objective is to minimize the number of stops for each schools and
the total walking distance. This is similar to a facility location
problem.

**** Variable
     :PROPERTIES:
     :CUSTOM_ID: variable
     :END:

$z_c$: binary whether stop c is selected for school S.

$y_{p,c}$: binary whether student p is assigned to stop c.Â 

**** Objective and Constraints
     :PROPERTIES:
     :CUSTOM_ID: objective-and-constraints
     :END:

For each school S:

$$ min \sum_{c \in C} z_c + \beta \sum_{p \in P_s} \sum_{c \in C_p} d_{p,c} y_{p,c}$$

subject to:

1. student p is assigned to c only if stop c is selected for school s.
   $$y_{p,c} \leq z_c,  \forall p \in P_s , c \in C_p$$

2. Each student is assigned to 1 stop
   $$\sum_{c \in C_p} y_{p,c} = 1 ,\forall p \in P_s $$

Where $\beta$ is the trade-off of the total number of stops and walking
distance.

*** 1.2 single school routing
    :PROPERTIES:
    :CUSTOM_ID: single-school-routing
    :END:

After the stop assignment, $C_s$ is the set of bus stops which serve
school S. $n_{c,S}$ is number of students from school S at a stop c.

**** Bus
     :PROPERTIES:
     :CUSTOM_ID: bus
     :END:

| Identifier               | index/set   | comment                            |
|--------------------------+-------------+------------------------------------|
| Bus Type                 | b/B         |                                    |
| Capacity $Q_b$           | b           |                                    |
| Wheelchair spots $W_b$   | b           | fixed number of wheelchair         |
| Bus depot $Y$            |             | *stored during the night or day*   |

**** Trip
     :PROPERTIES:
     :CUSTOM_ID: trip
     :END:

| Identifier         | index/set   | comment                                                         |
|--------------------+-------------+-----------------------------------------------------------------|
| $t_{c,S}^{pick}$   |             | length of time to pick all p for S at c; function of num of p   |
| $t_{S}^{drop}$     |             | length of time to drop all p at school S; fixed                 |

For any two location $l_1, l_2 \in S \cup C \cup Y$, and a given a
particular time of day \tau: $t_{l_1,l_2,\tau}^{drive}$
